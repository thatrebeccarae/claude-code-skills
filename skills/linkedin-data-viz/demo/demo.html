<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LinkedIn Data Visualization — Live Demo</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
/* ============================================================
   Carrier Dark Theme — Inline for Demo
   ============================================================ */
:root {
  --bg-primary: #0D1117; --bg-surface: #161B22; --bg-elevated: #1E2329;
  --bg-glass: rgba(255,255,255,0.04);
  --text-primary: #fdfdfe; --text-secondary: #8b949e; --text-muted: #7d8590;
  --accent-primary: #4eadab; --accent-hover: #6bc0be;
  --viz-teal: #4eadab; --viz-lime: #56d4a5; --viz-cyan: #6bc0be;
  --viz-purple: #8b7ec8; --viz-orange: #d4845a; --viz-gold: #c9a84c;
  --viz-muted: #8b949e; --viz-deep: #4a9f9d; --viz-slate: #7d8590;
  --viz-pink: #c75b6f;
  --border-subtle: rgba(255,255,255,0.08); --border-hover: rgba(255,255,255,0.12);
  --max-w: 1100px; --radius-sm: 6px; --radius-md: 10px; --radius-lg: 12px;
}
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{-webkit-font-smoothing:antialiased;scroll-behavior:smooth;scroll-padding-top:72px}
body{background:var(--bg-primary);color:var(--text-secondary);font-family:'Inter',system-ui,sans-serif;font-size:15px;line-height:1.6}
::-webkit-scrollbar{width:6px;height:6px}::-webkit-scrollbar-track{background:var(--bg-primary)}::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.12);border-radius:3px}
h1,h2,h3{color:var(--text-primary);font-weight:300;letter-spacing:-0.03em}
.container{max-width:var(--max-w);margin:0 auto;padding:0 40px}

/* Nav */
.nav{position:sticky;top:0;z-index:100;background:rgba(13,17,23,0.88);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);border-bottom:1px solid var(--border-subtle);padding:0 40px}
.nav-inner{max-width:var(--max-w);margin:0 auto;display:flex;align-items:center;gap:8px;overflow-x:auto;scrollbar-width:none;padding:12px 0}
.nav-inner::-webkit-scrollbar{display:none}
.nav-brand{font-weight:600;font-size:0.85rem;color:var(--text-primary);margin-right:12px;white-space:nowrap;flex-shrink:0}
.nav-link{padding:6px 14px;border-radius:20px;font-size:0.75rem;font-weight:500;color:var(--text-muted);text-decoration:none;white-space:nowrap;border:1px solid transparent;transition:all 0.15s}
.nav-link:hover{border-color:var(--border-subtle);background:var(--bg-surface);color:var(--text-secondary)}
.nav-link.active{background:var(--accent-primary);color:var(--bg-primary);border-color:var(--accent-primary)}

/* Hero */
.hero{padding:80px 40px 60px;text-align:center}
.hero h1{font-size:3rem;letter-spacing:-0.04em;margin-bottom:12px}
.hero .lead{font-size:1.05rem;color:var(--text-secondary);max-width:640px;margin:0 auto 40px}
.hero-stats{display:flex;justify-content:center;gap:48px;flex-wrap:wrap}

/* Sections */
section{padding:60px 40px}
section:nth-child(even of section){background:var(--bg-surface)}
.section-inner{max-width:var(--max-w);margin:0 auto}
.section-num{font-size:0.7rem;font-weight:600;color:var(--accent-primary);text-transform:uppercase;letter-spacing:0.1em;margin-bottom:6px;font-family:'JetBrains Mono',monospace}
.section-title{font-size:2rem;margin-bottom:8px}
.section-subtitle{font-size:0.95rem;color:var(--text-secondary);margin-bottom:32px;max-width:700px}

/* Cards */
.card{background:var(--bg-surface);border:1px solid var(--border-subtle);border-radius:var(--radius-lg);padding:28px;margin-bottom:20px;transition:transform 150ms,box-shadow 150ms,border-color 150ms}
.card:hover{border-color:var(--border-hover)}
.card-title{font-weight:500;font-size:1rem;color:var(--text-primary);margin-bottom:16px}
.chart-box{height:420px;position:relative}

/* Stats */
.stats-row{display:flex;gap:32px;margin-bottom:28px;flex-wrap:wrap}
.stat{text-align:center}
.stat-value{font-size:1.8rem;font-weight:300;color:var(--accent-primary);font-family:'JetBrains Mono',monospace}
.stat-label{font-size:0.7rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.05em}

/* Insights */
.insight-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:14px}
.insight{padding:16px;border-radius:var(--radius-sm);background:var(--bg-elevated);border:1px solid var(--border-subtle)}
.insight-label{font-size:0.72rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.04em;margin-bottom:4px}
.insight-value{font-size:0.88rem;font-weight:500;color:var(--text-primary)}
.takeaway{font-size:0.88rem;color:var(--text-secondary);margin-bottom:10px;padding-left:16px;border-left:3px solid var(--border-subtle)}
.takeaway strong{color:var(--text-primary)}

/* D3 Graph */
#graph-container{position:relative}#graph{width:100%;height:800px}#graph svg{width:100%;height:100%}
.node-label{font-family:'Inter',sans-serif;font-weight:500;font-size:11px;fill:var(--text-primary);pointer-events:none}
.node-count{display:none}
.graph-link{stroke:rgba(255,255,255,0.1);stroke-opacity:0.6}
.graph-tooltip{position:absolute;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:var(--radius-md);padding:12px 16px;font-size:0.85rem;line-height:1.6;box-shadow:0 8px 24px rgba(0,0,0,0.4);pointer-events:none;opacity:0;transition:opacity 0.2s;max-width:260px;z-index:10;color:var(--text-primary)}
.graph-tooltip strong{font-weight:600}.graph-tooltip .companies{color:var(--text-muted);font-size:0.8rem;margin-top:4px}
.graph-legend{display:flex;flex-wrap:wrap;gap:10px 18px;margin-top:16px;padding-top:14px;border-top:1px solid var(--border-subtle)}
.legend-item{display:flex;align-items:center;gap:5px;font-size:0.75rem;color:var(--text-secondary)}
.legend-dot{width:9px;height:9px;border-radius:50%;flex-shrink:0}

/* Inference */
.inference-grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
@media(max-width:768px){.inference-grid{grid-template-columns:1fr}}
.inference-card{border:1px solid var(--border-subtle);border-radius:var(--radius-md);padding:18px;background:var(--bg-elevated);transition:transform 0.15s}
.inference-card:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,0.3)}
.card-header{display:flex;align-items:center;gap:8px;margin-bottom:10px}
.verdict{display:inline-block;font-size:0.65rem;font-weight:600;text-transform:uppercase;letter-spacing:0.06em;padding:2px 9px;border-radius:20px}
.verdict.accurate{background:rgba(78,173,171,0.15);color:var(--accent-primary)}
.verdict.partial{background:rgba(201,168,76,0.12);color:var(--viz-gold)}
.verdict.wrong{background:rgba(199,91,111,0.12);color:var(--viz-pink)}
.card-label{font-weight:500;font-size:0.9rem;color:var(--text-primary)}
.linkedin-says{font-size:0.82rem;color:var(--text-muted);margin-bottom:6px}
.reality{font-size:0.85rem;color:var(--text-secondary)}.reality strong{color:var(--text-primary)}

/* Tags */
.follows-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:10px}
.follows-cat{border:1px solid var(--border-subtle);border-radius:var(--radius-sm);padding:12px;text-align:center;background:var(--bg-elevated)}
.follows-cat-count{font-size:1.5rem;font-weight:300;font-family:'JetBrains Mono',monospace}
.follows-cat-label{font-size:0.72rem;color:var(--text-muted);margin-top:2px}
.tag-cloud{display:flex;flex-wrap:wrap;gap:5px;margin-bottom:16px}
.tag{display:inline-block;padding:3px 10px;border-radius:20px;font-size:0.72rem;border:1px solid var(--border-subtle);color:var(--text-muted);background:var(--bg-elevated)}
.tag.relevant{background:rgba(78,173,171,0.12);border-color:rgba(78,173,171,0.3);color:var(--accent-primary)}
.tag.irrelevant{background:rgba(199,91,111,0.08);border-color:rgba(199,91,111,0.15);color:var(--viz-pink)}
.tag.neutral{background:var(--bg-elevated);color:var(--text-secondary)}

/* Comparison */
.comparison-row{display:grid;grid-template-columns:1fr auto 1fr;gap:14px;align-items:start;padding:14px 0;border-bottom:1px solid var(--border-subtle)}
.comparison-row:last-child{border-bottom:none}.col-linkedin{text-align:right}
.vs-divider{font-size:0.68rem;color:var(--text-muted);font-weight:600;padding-top:4px;text-transform:uppercase;letter-spacing:0.1em}
.col-label{font-size:0.72rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.04em;margin-bottom:3px}
.col-value{font-size:0.85rem}.col-linkedin .col-value{color:var(--viz-pink)}.col-reality .col-value{color:var(--accent-primary);font-weight:500}

/* Messages */
.filters{display:flex;gap:7px;margin-bottom:18px;flex-wrap:wrap}
.filter-btn{padding:5px 14px;border-radius:20px;border:1px solid var(--border-subtle);background:var(--bg-surface);font-size:0.78rem;font-family:'Inter',sans-serif;cursor:pointer;transition:all 0.15s;color:var(--text-muted)}
.filter-btn.active{background:var(--accent-primary);color:var(--bg-primary);border-color:var(--accent-primary)}
.filter-btn:hover{border-color:var(--accent-primary);color:var(--text-secondary)}
.msg-cards{display:flex;flex-direction:column;gap:10px}
.msg-card{background:var(--bg-surface);border:1px solid var(--border-subtle);border-radius:var(--radius-md);padding:16px 20px;display:flex;gap:16px;align-items:flex-start;transition:transform 0.15s,box-shadow 0.15s}
.msg-card:hover{transform:translateY(-1px);box-shadow:0 4px 16px rgba(0,0,0,0.3)}
.msg-card.hidden{display:none}
.urgency{width:4px;border-radius:2px;min-height:50px;flex-shrink:0;align-self:stretch}
.urgency.hot{background:var(--viz-gold)}.urgency.warm{background:var(--accent-primary)}.urgency.cool{background:var(--border-subtle)}
.msg-body{flex:1;min-width:0}
.msg-header{display:flex;justify-content:space-between;align-items:baseline;margin-bottom:4px;flex-wrap:wrap;gap:6px}
.msg-from{font-weight:600;font-size:0.9rem;color:var(--text-primary)}
.msg-meta{display:flex;gap:10px;align-items:center}
.msg-date{font-size:0.72rem;color:var(--text-muted)}
.msg-days{font-size:0.68rem;font-weight:600;padding:2px 7px;border-radius:10px;white-space:nowrap}
.msg-days.urgent{background:rgba(201,168,76,0.12);color:var(--viz-gold)}
.msg-days.moderate{background:rgba(78,173,171,0.12);color:var(--accent-primary)}
.msg-days.old{background:var(--bg-elevated);color:var(--text-muted)}
.msg-subject{font-size:0.78rem;color:var(--viz-purple);font-weight:500;margin-bottom:4px}
.msg-content{font-size:0.82rem;color:var(--text-secondary);line-height:1.5}
.msg-tags{display:flex;gap:5px;margin-top:6px;flex-wrap:wrap}
.msg-tag{font-size:0.65rem;padding:2px 7px;border-radius:10px;background:var(--bg-elevated);color:var(--text-muted);border:1px solid var(--border-subtle)}
.msg-tag.opportunity{background:rgba(201,168,76,0.08);border-color:rgba(201,168,76,0.15);color:var(--viz-gold)}
.msg-tag.relationship{background:rgba(78,173,171,0.08);border-color:rgba(78,173,171,0.15);color:var(--accent-primary)}
.msg-tag.network{background:rgba(139,126,200,0.08);border-color:rgba(139,126,200,0.15);color:var(--viz-purple)}

/* Clusters */
.cluster-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:14px;margin-top:20px}
.cluster-card{background:var(--bg-surface);border:1px solid var(--border-subtle);border-radius:var(--radius-md);padding:16px;transition:transform 0.15s}
.cluster-card:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,0.3)}
.cluster-header{display:flex;justify-content:space-between;align-items:baseline;margin-bottom:8px}
.cluster-name{font-weight:600;font-size:0.85rem}
.cluster-count{font-size:1.3rem;font-weight:300;font-family:'JetBrains Mono',monospace}
.cluster-items{font-size:0.75rem;color:var(--text-muted);line-height:1.8}
.cluster-items span{display:inline-block;padding:1px 7px;background:var(--bg-elevated);border-radius:4px;margin:2px}

/* Charts Pair */
.charts-pair{display:grid;grid-template-columns:1fr 1fr;gap:20px}
@media(max-width:768px){.charts-pair{grid-template-columns:1fr}}
.breakdown-row{display:flex;align-items:center;gap:10px;padding:12px 0;border-bottom:1px solid var(--border-subtle)}
.breakdown-row:last-child{border-bottom:none}
.breakdown-dot{width:11px;height:11px;border-radius:50%;flex-shrink:0}
.breakdown-label{flex:1;font-size:0.85rem;color:var(--text-secondary)}.breakdown-label strong{color:var(--text-primary)}
.breakdown-count{font-size:1.1rem;font-weight:300;min-width:45px;text-align:right;color:var(--text-primary);font-family:'JetBrains Mono',monospace}
.breakdown-pct{font-size:0.72rem;color:var(--text-muted);min-width:38px;text-align:right}
.breakdown-bar{height:5px;border-radius:3px;flex:0 0 100px;background:var(--bg-elevated);position:relative;overflow:hidden}
.breakdown-fill{position:absolute;left:0;top:0;height:100%;border-radius:3px}

/* Timeline */
.timeline-table{background:var(--bg-surface);border:1px solid var(--border-subtle);border-radius:var(--radius-lg);overflow:hidden}
.tl-header{display:grid;grid-template-columns:30px 1fr 150px 100px 70px;gap:10px;padding:10px 18px;background:var(--bg-elevated);font-size:0.68rem;text-transform:uppercase;letter-spacing:0.06em;color:var(--text-muted);font-weight:600;border-bottom:1px solid var(--border-subtle)}
.tl-row{display:grid;grid-template-columns:30px 1fr 150px 100px 70px;gap:10px;padding:10px 18px;align-items:center;border-bottom:1px solid rgba(255,255,255,0.04);transition:background 0.1s}
.tl-row:hover{background:var(--bg-elevated)}.tl-row:last-child{border-bottom:none}
.direction-dot{width:9px;height:9px;border-radius:50%;margin:0 auto}
.direction-dot.inbound{background:var(--accent-primary)}.direction-dot.outbound{background:var(--viz-gold)}.direction-dot.unknown{background:var(--text-muted)}
.tl-name{font-weight:500;font-size:0.85rem;color:var(--text-primary)}
.tl-company{font-size:0.75rem;color:var(--text-muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.tl-date{font-size:0.78rem;color:var(--text-secondary)}.tl-msgs{text-align:center}
.msg-bar{display:inline-block;height:5px;border-radius:3px;background:var(--accent-primary)}
.msg-count{font-size:0.72rem;color:var(--text-muted);margin-top:2px}
@media(max-width:768px){.tl-header,.tl-row{grid-template-columns:26px 1fr 70px}.tl-company,.tl-date{display:none}}

/* Strata */
.strata-container{border-radius:var(--radius-lg);overflow:hidden;border:1px solid var(--border-subtle)}
.strata-layer{display:flex;justify-content:space-between;align-items:center;padding:22px 28px;border-bottom:1px solid rgba(255,255,255,0.06);transition:all 0.2s;cursor:default}
.strata-layer:hover{filter:brightness(1.15)}.strata-layer:hover .strata-detail{opacity:1;max-height:60px;margin-top:6px}
.strata-era{font-weight:600;font-size:0.9rem;letter-spacing:-0.01em}
.strata-desc{font-size:0.8rem;opacity:0.7;margin-top:2px}
.strata-detail{font-size:0.73rem;opacity:0;max-height:0;overflow:hidden;transition:all 0.3s;line-height:1.5}
.strata-count{font-size:1.8rem;font-weight:300;opacity:0.9;font-family:'JetBrains Mono',monospace}
.strata-pct{font-size:0.68rem;opacity:0.5;font-family:'JetBrains Mono',monospace}
.strata-right{text-align:right;flex-shrink:0;margin-left:20px}
.layer-0{background:#0D1117;color:#4eadab}.layer-1{background:#111820;color:#5ab8b6}
.layer-2{background:#151E28;color:#6bc0be}.layer-3{background:#1A2530;color:#7dcbc9}
.layer-4{background:#1E2B38;color:#8ed6d4}.layer-5{background:#233240;color:#9fe1df}
.layer-6{background:#283948;color:#b0ecea}.layer-7{background:#2D4050;color:#c1f7f5}
.layer-8{background:#324758;color:#fdfdfe}

/* Posting Correlation */
.highlight-row{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;margin-top:28px}
@media(max-width:768px){.highlight-row{grid-template-columns:1fr}}
.highlight-card{background:var(--bg-surface);border:1px solid var(--border-subtle);border-radius:var(--radius-lg);padding:28px;text-align:center}
.highlight-value{font-size:2.2rem;font-weight:300;color:var(--viz-gold);font-family:'JetBrains Mono',monospace;letter-spacing:-0.02em}
.highlight-label{font-size:0.85rem;color:var(--text-secondary);margin-top:4px}
.highlight-note{font-size:0.75rem;color:var(--text-muted);margin-top:4px}
.prompt-box{background:rgba(201,168,76,0.06);border:1px solid rgba(201,168,76,0.15);border-radius:var(--radius-lg);padding:28px;margin-top:28px}
.prompt-label{font-size:0.7rem;font-weight:600;text-transform:uppercase;letter-spacing:0.08em;color:var(--viz-gold);margin-bottom:12px}
.prompt-text{font-size:0.92rem;color:var(--text-primary);line-height:1.7;padding:16px 20px;background:var(--bg-surface);border:1px solid var(--border-subtle);border-radius:var(--radius-md);font-family:'Inter',sans-serif}
.prompt-sources{font-size:0.75rem;color:var(--text-muted);margin-top:10px}

/* Footer */
.footer{text-align:center;padding:48px 40px;font-size:0.8rem;color:var(--text-muted);border-top:1px solid var(--border-subtle)}
.footer a{color:var(--accent-primary);text-decoration:none}.footer a:hover{color:var(--accent-hover)}

/* Demo banner */
.demo-banner{background:rgba(78,173,171,0.1);border-bottom:1px solid rgba(78,173,171,0.2);padding:10px 40px;text-align:center;font-size:0.82rem;color:var(--accent-primary)}
.demo-banner a{color:var(--text-primary);font-weight:600;text-decoration:none;border-bottom:1px solid var(--accent-primary)}
</style>
</head>
<body>

<!-- DEMO BANNER -->
<div class="demo-banner">
  This is a demo with sample data. <a href="index.html">Install the skill</a> to visualize your own LinkedIn export.
</div>

<!-- NAV -->
<nav class="nav">
  <div class="nav-inner">
    <span class="nav-brand">LinkedIn Data</span>
    <a href="#network" class="nav-link">Network</a>
    <a href="#inferences" class="nav-link">Inferences</a>
    <a href="#messages" class="nav-link">Messages</a>
    <a href="#companies" class="nav-link">Companies</a>
    <a href="#invitations" class="nav-link">Invitations</a>
    <a href="#quality" class="nav-link">Quality</a>
    <a href="#timeline" class="nav-link">Who's Connecting</a>
    <a href="#inbox" class="nav-link">Inbox</a>
    <a href="#posting" class="nav-link">Posting</a>
    <a href="#strata" class="nav-link">Strata</a>
  </div>
</nav>

<!-- HERO -->
<header class="hero">
  <h1>LinkedIn Data Export Visualization</h1>
  <p class="lead">A complete visual analysis of your LinkedIn data — connections, messages, invitations, and followed companies.</p>
  <div class="hero-stats" id="hero-stats"></div>
</header>

<!-- 01: NETWORK UNIVERSE -->
<section id="network">
<div class="section-inner">
  <div class="section-num">01</div>
  <h2 class="section-title">Network Universe</h2>
  <p class="section-subtitle">Connections clustered by role and industry. Node size reflects cluster population. Links show shared employers between groups. Drag nodes to explore.</p>
  <div class="stats-row" id="network-stats"></div>
  <div class="card" id="graph-container">
    <div id="graph"></div>
    <div class="graph-tooltip" id="tooltip"></div>
    <div class="graph-legend" id="legend"></div>
  </div>
</div>
</section>

<!-- 02: INFERENCES VS REALITY -->
<section id="inferences">
<div class="section-inner">
  <div class="section-num">02</div>
  <h2 class="section-title">Inferences vs Reality</h2>
  <p class="section-subtitle">What LinkedIn thinks it knows about you, compared to what your actual data reveals.</p>
  <div class="stats-row" id="inference-stats"></div>
  <div class="card">
    <div class="card-title">LinkedIn's Inferences</div>
    <div class="inference-grid" id="inference-grid"></div>
  </div>
  <div class="card">
    <div class="card-title" id="follows-title">What You Actually Follow</div>
    <div class="follows-grid" id="follows-grid"></div>
  </div>
  <div class="card">
    <div class="card-title">Ad Targeting: What LinkedIn Sells About You</div>
    <p style="font-size:0.82rem;color:var(--text-muted);margin-bottom:16px;">LinkedIn assigns you to interest categories for advertisers. Sample — <span style="color:var(--accent-primary);">relevant</span> vs <span style="color:var(--viz-pink);">questionable</span>:</p>
    <div class="tag-cloud" id="interest-tags"></div>
    <div style="margin-top:16px;">
      <div class="card-title" style="font-size:0.9rem;">The Verdict</div>
      <div id="verdict-rows"></div>
    </div>
  </div>
</div>
</section>

<!-- 03: HIGH-VALUE MESSAGES -->
<section id="messages">
<div class="section-inner">
  <div class="section-num">03</div>
  <h2 class="section-title">High-Value Messages</h2>
  <p class="section-subtitle">Unanswered LinkedIn messages ranked by potential value. Filtered to surface genuine opportunities.</p>
  <div class="stats-row" id="msg-stats"></div>
  <div class="filters">
    <button class="filter-btn active" data-filter="all">All Genuine</button>
    <button class="filter-btn" data-filter="opportunity">Opportunities</button>
    <button class="filter-btn" data-filter="relationship">Relationships</button>
    <button class="filter-btn" data-filter="network">Networking</button>
  </div>
  <div class="msg-cards" id="msg-cards"></div>
</div>
</section>

<!-- 04: COMPANY FOLLOWS CLUSTERING -->
<section id="companies">
<div class="section-inner">
  <div class="section-num">04</div>
  <h2 class="section-title">Company Follows Clustering</h2>
  <p class="section-subtitle">Followed companies grouped by theme. Your professional interest map.</p>
  <div class="card"><div class="chart-box"><canvas id="clusterChart"></canvas></div></div>
  <div class="cluster-grid" id="cluster-grid"></div>
</div>
</section>

<!-- 05: INBOUND VS OUTBOUND -->
<section id="invitations">
<div class="section-inner">
  <div class="section-num">05</div>
  <h2 class="section-title">Inbound vs Outbound</h2>
  <p class="section-subtitle">Connection request patterns showing who's reaching out to whom, and how the balance shifted over time.</p>
  <div class="stats-row" id="inv-stats"></div>
  <div class="card"><div class="chart-box"><canvas id="invChart"></canvas></div></div>
  <div class="card"><div class="insight-grid" id="inv-insights"></div></div>
</div>
</section>

<!-- 06: CONNECTION QUALITY -->
<section id="quality">
<div class="section-inner">
  <div class="section-num">06</div>
  <h2 class="section-title">Connections vs Real Relationships</h2>
  <p class="section-subtitle">Cross-referencing connections with messaging data to reveal network depth.</p>
  <div class="stats-row" id="quality-stats"></div>
  <div class="charts-pair">
    <div class="card"><div class="card-title">Relationship Depth</div><div class="chart-box"><canvas id="donutChart"></canvas></div></div>
    <div class="card"><div class="card-title">Messaged vs Never</div><div class="chart-box"><canvas id="barChart"></canvas></div></div>
  </div>
  <div class="card" id="quality-breakdown"></div>
  <div class="card" id="quality-takeaways"></div>
</div>
</section>

<!-- 07: WHO'S CONNECTING -->
<section id="timeline">
<div class="section-inner">
  <div class="section-num">07</div>
  <h2 class="section-title">Who's Connecting?</h2>
  <p class="section-subtitle">Inbound vs outbound connections by seniority. Left = you reached out. Right = they found you.</p>
  <div class="card"><div class="chart-box" style="height:380px;"><canvas id="pyramidChart"></canvas></div></div>
  <div class="stats-row" id="pyramid-stats"></div>
</div>
</section>

<!-- 08: INBOX QUALITY -->
<section id="inbox">
<div class="section-inner">
  <div class="section-num">08</div>
  <h2 class="section-title">Inbox Quality Analysis</h2>
  <p class="section-subtitle">Categorizing inbound messages as genuine professional outreach vs. noise over time.</p>
  <div class="stats-row" id="inbox-stats"></div>
  <div class="card"><div class="chart-box"><canvas id="inboxChart"></canvas></div></div>
  <div class="card"><div class="insight-grid" id="inbox-insights"></div></div>
</div>
</section>

<!-- 09: DOES POSTING ACTUALLY WORK? -->
<section id="posting">
<div class="section-inner">
  <div class="section-num">09</div>
  <h2 class="section-title">Does Posting Actually Work?</h2>
  <p class="section-subtitle">Correlation between posting frequency and new connection requests.</p>
  <div class="card"><div class="chart-box" style="height:480px;"><canvas id="postingChart"></canvas></div></div>
  <div class="highlight-row" id="posting-highlights"></div>
</div>
</section>

<!-- 10: CAREER STRATA -->
<section id="strata">
<div class="section-inner">
  <div class="section-num">10</div>
  <h2 class="section-title">Career Strata</h2>
  <p class="section-subtitle">Your network as geological layers. Each stratum represents a career phase, with connections accumulated during that era. Hover to expand.</p>
  <div class="stats-row" id="strata-stats"></div>
  <div class="strata-container" id="strata-container"></div>
</div>
</section>

<!-- FOOTER -->
<footer class="footer">
  <p>Built by <a href="https://linkedin.com/in/rebeccaraebarton" target="_blank">Rebecca Rae Barton</a></p>
  <div style="display:flex;justify-content:center;gap:20px;margin-top:12px;">
    <a href="https://linkedin.com/in/rebeccaraebarton" target="_blank" title="LinkedIn" style="color:var(--text-muted);transition:color 0.15s;">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433a2.062 2.062 0 01-2.063-2.065 2.064 2.064 0 112.063 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
    </a>
    <a href="https://github.com/thatrebeccarae" target="_blank" title="GitHub" style="color:var(--text-muted);transition:color 0.15s;">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
    </a>
    <a href="https://instagram.com/thatrebeccarae" target="_blank" title="Instagram" style="color:var(--text-muted);transition:color 0.15s;">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0C8.74 0 8.333.015 7.053.072 5.775.132 4.905.333 4.14.63c-.789.306-1.459.717-2.126 1.384S.935 3.35.63 4.14C.333 4.905.131 5.775.072 7.053.012 8.333 0 8.74 0 12s.015 3.667.072 4.947c.06 1.277.261 2.148.558 2.913.306.788.717 1.459 1.384 2.126.667.666 1.336 1.079 2.126 1.384.766.296 1.636.499 2.913.558C8.333 23.988 8.74 24 12 24s3.667-.015 4.947-.072c1.277-.06 2.148-.262 2.913-.558.788-.306 1.459-.718 2.126-1.384.666-.667 1.079-1.335 1.384-2.126.296-.765.499-1.636.558-2.913.06-1.28.072-1.687.072-4.947s-.015-3.667-.072-4.947c-.06-1.277-.262-2.149-.558-2.913-.306-.789-.718-1.459-1.384-2.126C21.319 1.347 20.651.935 19.86.63c-.765-.297-1.636-.499-2.913-.558C15.667.012 15.26 0 12 0zm0 2.16c3.203 0 3.585.016 4.85.071 1.17.055 1.805.249 2.227.415.562.217.96.477 1.382.896.419.42.679.819.896 1.381.164.422.36 1.057.413 2.227.057 1.266.07 1.646.07 4.85s-.015 3.585-.074 4.85c-.061 1.17-.256 1.805-.421 2.227-.224.562-.479.96-.899 1.382-.419.419-.824.679-1.38.896-.42.164-1.065.36-2.235.413-1.274.057-1.649.07-4.859.07-3.211 0-3.586-.015-4.859-.074-1.171-.061-1.816-.256-2.236-.421-.569-.224-.96-.479-1.379-.899-.421-.419-.69-.824-.9-1.38-.165-.42-.359-1.065-.42-2.235-.045-1.26-.061-1.649-.061-4.844 0-3.196.016-3.586.061-4.861.061-1.17.255-1.814.42-2.234.21-.57.479-.96.9-1.381.419-.419.81-.689 1.379-.898.42-.166 1.051-.361 2.221-.421 1.275-.045 1.65-.06 4.859-.06l.045.03zm0 3.678a6.162 6.162 0 100 12.324 6.162 6.162 0 100-12.324zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm7.846-10.405a1.441 1.441 0 11-2.882 0 1.441 1.441 0 012.882 0z"/></svg>
    </a>
  </div>
</footer>

<!-- SAMPLE DATA -->
<script>
const DATA = {
  hero: {
    stats: [
      { value: "2,264", label: "Connections" },
      { value: "4,210", label: "Messages" },
      { value: "142", label: "Companies Followed" },
      { value: "12 yrs", label: "Network Span" }
    ]
  },
  network: {
    stats: [
      { value: "2,264", label: "Total Connections" },
      { value: "10", label: "Role Clusters" },
      { value: "347", label: "Companies" }
    ],
    nodes: [
      { id: "Marketing", size: 412, group: 0, top_companies: ["Ogilvy Group", "HubSpot", "Mailchimp"], children: [
        { id: "Growth", size: 118, group: 0, children: [
          { id: "PLG Specialists", size: 42, group: 0 },
          { id: "ABM Strategists", size: 38, group: 0 },
          { id: "Demand Gen", size: 38, group: 0 }
        ]},
        { id: "Brand & Creative", size: 95, group: 0, children: [
          { id: "Brand Strategists", size: 45, group: 0 },
          { id: "Creative Directors", size: 30, group: 0 },
          { id: "Copywriters", size: 20, group: 0 }
        ]},
        { id: "Lifecycle", size: 87, group: 0 },
        { id: "Content & SEO", size: 64, group: 0 },
        { id: "Performance", size: 48, group: 0 }
      ]},
      { id: "Tech / Engineering", size: 318, group: 1, top_companies: ["Stripe", "Vercel", "Datadog"], children: [
        { id: "Full-Stack Dev", size: 102, group: 1, children: [
          { id: "Backend", size: 42, group: 1 },
          { id: "Frontend Web", size: 35, group: 1 },
          { id: "Mobile", size: 25, group: 1 }
        ]},
        { id: "Data / ML", size: 78, group: 1, children: [
          { id: "Data Engineers", size: 32, group: 1 },
          { id: "ML Engineers", size: 28, group: 1 },
          { id: "Analytics", size: 18, group: 1 }
        ]},
        { id: "DevOps / Infra", size: 65, group: 1 },
        { id: "Frontend", size: 73, group: 1 }
      ]},
      { id: "Founders", size: 247, group: 2, top_companies: ["YC W23", "Sequoia Scout", "First Round"], children: [
        { id: "VC-Backed", size: 89, group: 2, children: [
          { id: "Series A-B", size: 38, group: 2 },
          { id: "Seed Stage", size: 31, group: 2 },
          { id: "Growth Stage", size: 20, group: 2 }
        ]},
        { id: "Bootstrapped", size: 72, group: 2, children: [
          { id: "SaaS Founders", size: 35, group: 2 },
          { id: "Agency Owners", size: 22, group: 2 },
          { id: "Solopreneurs", size: 15, group: 2 }
        ]},
        { id: "AI / Deep Tech", size: 51, group: 2 },
        { id: "DTC Founders", size: 35, group: 2 }
      ]},
      { id: "Sales", size: 196, group: 3, top_companies: ["Salesforce", "Gong", "Outreach"], children: [
        { id: "Account Exec", size: 74, group: 3, children: [
          { id: "Enterprise AE", size: 32, group: 3 },
          { id: "Mid-Market", size: 26, group: 3 },
          { id: "SMB Sales", size: 16, group: 3 }
        ]},
        { id: "Sales Leaders", size: 58, group: 3 },
        { id: "SDR / BDR", size: 38, group: 3 },
        { id: "RevOps", size: 26, group: 3 }
      ]},
      { id: "Product", size: 155, group: 4, top_companies: ["Figma", "Linear", "Notion"], children: [
        { id: "Product Mgmt", size: 68, group: 4, children: [
          { id: "B2B PM", size: 30, group: 4 },
          { id: "B2C PM", size: 22, group: 4 },
          { id: "Platform PM", size: 16, group: 4 }
        ]},
        { id: "Product Strategy", size: 48, group: 4 },
        { id: "Growth PM", size: 39, group: 4 }
      ]},
      { id: "Design", size: 127, group: 5, top_companies: ["IDEO", "Pentagram", "Fantasy"], children: [
        { id: "UX / UI", size: 55, group: 5 },
        { id: "Brand Design", size: 42, group: 5 },
        { id: "Design Leads", size: 30, group: 5 }
      ]},
      { id: "Recruiting", size: 114, group: 6, top_companies: ["Korn Ferry", "Lever", "Greenhouse"], children: [
        { id: "Tech Recruiters", size: 48, group: 6 },
        { id: "Exec Search", size: 36, group: 6 },
        { id: "HR / People", size: 30, group: 6 }
      ]},
      { id: "Consulting", size: 98, group: 7, top_companies: ["McKinsey", "Deloitte", "BCG"], children: [
        { id: "Strategy", size: 42, group: 7 },
        { id: "Digital / Tech", size: 32, group: 7 },
        { id: "Fractional Execs", size: 24, group: 7 }
      ]},
      { id: "Executive", size: 92, group: 8, top_companies: ["Stripe", "Notion", "Figma"], children: [
        { id: "C-Suite", size: 38, group: 8 },
        { id: "VP-Level", size: 34, group: 8 },
        { id: "Board / Advisors", size: 20, group: 8 }
      ]},
      { id: "Operations", size: 88, group: 9, top_companies: ["Shopify", "Flexport", "DoorDash"], children: [
        { id: "Supply Chain", size: 32, group: 9 },
        { id: "Biz Ops", size: 30, group: 9 },
        { id: "Finance / FP&A", size: 26, group: 9 }
      ]}
    ],
    links: [
      { source: "Marketing", target: "Sales", strength: 18 },
      { source: "Marketing", target: "Founders", strength: 15 },
      { source: "Marketing", target: "Product", strength: 12 },
      { source: "Tech / Engineering", target: "Product", strength: 22 },
      { source: "Tech / Engineering", target: "Founders", strength: 14 },
      { source: "Tech / Engineering", target: "Design", strength: 10 },
      { source: "Founders", target: "Executive", strength: 16 },
      { source: "Founders", target: "Consulting", strength: 8 },
      { source: "Sales", target: "Operations", strength: 11 },
      { source: "Sales", target: "Recruiting", strength: 9 },
      { source: "Product", target: "Design", strength: 19 },
      { source: "Product", target: "Executive", strength: 7 },
      { source: "Design", target: "Marketing", strength: 13 },
      { source: "Recruiting", target: "Executive", strength: 10 },
      { source: "Consulting", target: "Executive", strength: 12 },
      { source: "Operations", target: "Tech / Engineering", strength: 8 }
    ]
  },
  inferences: {
    stats: [
      { value: "5", label: "Inferences Made" },
      { value: "161", label: "Interest Categories" },
      { value: "739", label: "Skills Assigned" },
      { value: "138", label: "Companies Followed" },
      { value: "22", label: "Job Titles Targeted" }
    ],
    cards: [
      { label: "Not an HR Professional", verdict: "accurate", linkedin_says: "LinkedIn says: \"Not a human resources professional\" based on industry and headline.", reality: "Correct. You're a marketing/growth executive, not HR. Though LinkedIn categorizes your job functions as \"Operations, IT, Marketing\" which is closer." },
      { label: "Interest in Luxury Goods", verdict: "partial", linkedin_says: "LinkedIn says: \"Interested in luxury goods\" based on ad interactions and company pages.", reality: "You follow 15 luxury/fashion companies (LVMH, Vera Wang, Proenza Schouler), but your primary focus is DTC e-commerce (30 brands) and marketing tech (22 companies). Luxury is a slice, not the story." },
      { label: "Gender: Female", verdict: "accurate", linkedin_says: "LinkedIn says: \"FEMALE\" based on first name and other factors.", reality: "Correct." },
      { label: "Interested in a New Job", verdict: "accurate", linkedin_says: "LinkedIn says: \"Interested in a new job\" based on job searches and posting clicks in the last 30 days.", reality: "Correct. Actively in a job search with a structured pipeline, company research, and interview prep process." },
      { label: "Active Contributor & Public Influencer", verdict: "accurate", linkedin_says: "LinkedIn says: \"Active contributor who influences public opinion\" based on feed activity, groups, experience, and industry.", reality: "Correct. Member of 11 professional groups (Apple Alumni, Ecommerce Experts, Business of Fashion, etc.), active poster, and recognized as a \"Career Changer\" in member traits." }
    ],
    follows_count: 138,
    follows: [
      { count: 30, label: "DTC / E-Commerce Brands" },
      { count: 22, label: "Marketing & Martech" },
      { count: 22, label: "Recruiting & Executive Search" },
      { count: 15, label: "Luxury & Fashion" },
      { count: 10, label: "Tech & SaaS" },
      { count: 9, label: "Industry Events & Media" },
      { count: 7, label: "Finance & Investment" },
      { count: 7, label: "Dental & Healthcare" },
      { count: 6, label: "Art & Culture" },
      { count: 10, label: "Other" }
    ],
    interest_tags: [
      { name: "Content Marketing", type: "relevant" },
      { name: "E-Commerce", type: "relevant" },
      { name: "Email Marketing", type: "relevant" },
      { name: "Digital Marketing", type: "relevant" },
      { name: "Marketing Technology", type: "relevant" },
      { name: "Brand Management", type: "relevant" },
      { name: "Customer Experience", type: "relevant" },
      { name: "SEO", type: "relevant" },
      { name: "Social Media Marketing", type: "relevant" },
      { name: "Marketing Automation", type: "relevant" },
      { name: "Startups", type: "relevant" },
      { name: "User Experience", type: "relevant" },
      { name: "Entrepreneurship", type: "relevant" },
      { name: "Artificial Intelligence", type: "relevant" },
      { name: "Venture Capital", type: "neutral" },
      { name: "Financial Technology", type: "neutral" },
      { name: "Big Data", type: "neutral" },
      { name: "Cloud Computing", type: "neutral" },
      { name: "Business Intelligence", type: "neutral" },
      { name: "Robotics", type: "irrelevant" },
      { name: "Home Automation", type: "irrelevant" },
      { name: "Wearable Tech", type: "irrelevant" },
      { name: "Insurance", type: "irrelevant" },
      { name: "Banking", type: "irrelevant" },
      { name: "Cell Phones", type: "irrelevant" },
      { name: "Baby Tech", type: "irrelevant" },
      { name: "Dark Social", type: "irrelevant" },
      { name: "BYOD", type: "irrelevant" },
      { name: "Neuromarketing", type: "irrelevant" }
    ],
    verdicts: [
      { linkedin_label: "LinkedIn infers", linkedin_value: "Luxury goods enthusiast", reality_value: "DTC growth executive who appreciates luxury brands" },
      { linkedin_label: "LinkedIn targets", linkedin_value: "Technical Support Specialist, Sales Lead, CRM Head", reality_value: "Fractional CMO / VP Digital with P&L ownership" },
      { linkedin_label: "LinkedIn thinks", linkedin_value: "161 interest categories including Robotics & Insurance", reality_value: "E-commerce, marketing leadership, brand building, and art" },
      { linkedin_label: "LinkedIn assigns", linkedin_value: "739 skills including Laser Physics & Road Transport", reality_value: "Growth marketing, CRO, lifecycle, analytics, team building" }
    ]
  },
  messages: {
    stats: [
      { value: "28", label: "Unanswered" },
      { value: "8", label: "Hot" },
      { value: "12", label: "Warm" },
      { value: "8", label: "Cool" }
    ],
    cards: [
      { from: "CMO Role — Series B Martech Startup", type: "opportunity", urgency: "hot", date: "Jan 28, 2026", age: "13d ago", age_class: "urgent", subject: "CMO Role - Series B Martech Startup", content: "We're building something exciting in the email infrastructure space. I'd love to chat about a potential CMO opportunity.", tags: [{ type: "opportunity", label: "opportunity" }, { type: "relationship", label: "recruiter" }] },
      { from: "VP Marketing — DTC Attribution Deep-Dive", type: "relationship", urgency: "hot", date: "Jan 25, 2026", age: "16d ago", age_class: "urgent", content: "Your post on attribution modeling was really insightful. I'm running into similar challenges at our scale. Would you be open to a 20-min call?", tags: [{ type: "relationship", label: "relationship" }] },
      { from: "Series A Founder — Platform Partnership", type: "opportunity", urgency: "hot", date: "Jan 22, 2026", age: "19d ago", age_class: "urgent", subject: "Partnership Opportunity", content: "We just closed our Series A and I think there's a natural partnership between what you're building and our platform. Interested in exploring?", tags: [{ type: "opportunity", label: "opportunity" }, { type: "network", label: "partnership" }] },
      { from: "Lifecycle Marketer — SaaStr Followup", type: "network", urgency: "warm", date: "Jan 18, 2026", age: "23d ago", age_class: "moderate", content: "Great meeting you at SaaStr! I'd love to stay connected and share notes on the lifecycle marketing session.", tags: [{ type: "network", label: "networking" }] },
      { from: "DTC Brand — Klaviyo Audit & Roadmap", type: "opportunity", urgency: "warm", date: "Jan 12, 2026", age: "29d ago", age_class: "moderate", subject: "Consulting Project", content: "We're looking for someone to audit our Klaviyo setup and build a 90-day roadmap. Are you taking on new clients?", tags: [{ type: "opportunity", label: "opportunity" }] },
      { from: "Former Colleague — Fractional CMO Advice", type: "relationship", urgency: "warm", date: "Jan 8, 2026", age: "33d ago", age_class: "moderate", content: "Haven't caught up in a while! Saw you moved into fractional work. I did the same thing last year and have some insights to share.", tags: [{ type: "relationship", label: "relationship" }] },
      { from: "Newsletter Reader — 2026 Connection Request", type: "network", urgency: "cool", date: "Dec 15, 2025", age: "57d ago", age_class: "old", content: "Enjoyed your newsletter this week. Adding you to my list of people I want to connect with in 2026.", tags: [{ type: "network", label: "networking" }] },
      { from: "Email Marketing Summit — Speaker Invite", type: "opportunity", urgency: "cool", date: "Nov 20, 2025", age: "82d ago", age_class: "old", subject: "Speaking Opportunity", content: "We're organizing a virtual summit on email marketing trends. Would you be interested in a 30-min talk?", tags: [{ type: "opportunity", label: "opportunity" }, { type: "network", label: "speaking" }] }
    ]
  },
  company_clusters: {
    chart_labels: ["DTC/E-Comm", "Martech", "Recruiting", "Tech/SaaS", "Luxury", "Media", "Agency", "Finance"],
    chart_data: [32, 28, 24, 18, 15, 12, 8, 5],
    clusters: [
      { name: "DTC / E-Commerce", count: 32, companies: ["Glossier", "Warby Parker", "Allbirds", "Away", "Casper", "Everlane", "Outdoor Voices"] },
      { name: "Marketing / Martech", count: 28, companies: ["Klaviyo", "HubSpot", "Mailchimp", "Braze", "Iterable", "Customer.io", "ActiveCampaign"] },
      { name: "Recruiting / HR Tech", count: 24, companies: ["Greenhouse", "Lever", "Ashby", "Korn Ferry", "Heidrick & Struggles", "Robert Half"] },
      { name: "Tech / SaaS", count: 18, companies: ["Stripe", "Vercel", "Linear", "Notion", "Figma", "Datadog"] },
      { name: "Luxury / Fashion", count: 15, companies: ["LVMH", "Kering", "Tiffany & Co.", "Hermes", "Chanel"] },
      { name: "Media / Content", count: 12, companies: ["Morning Brew", "The Hustle", "Substack", "Beehiiv", "ConvertKit"] },
      { name: "Agency / Consulting", count: 8, companies: ["Ogilvy", "R/GA", "Publicis", "McKinsey"] },
      { name: "Finance / Fintech", count: 5, companies: ["Stripe", "Plaid", "Mercury", "Brex"] }
    ]
  },
  invitations: {
    stats: [
      { value: "389", label: "Total Invitations" },
      { value: "68%", label: "Inbound Rate" },
      { value: "Jan '26", label: "Peak Inbound" }
    ],
    chart_labels: ["Aug '25", "Sep '25", "Oct '25", "Nov '25", "Dec '25", "Jan '26", "Feb '26"],
    inbound: [22, 28, 35, 31, 44, 61, 42],
    outbound: [15, 12, 18, 14, 10, 8, 11],
    insights: [
      { label: "Strongest Month", value: "January 2026 (61 inbound) — likely driven by New Year networking surge" },
      { label: "Outbound Trend", value: "Declining since Oct, suggesting passive network growth dominance" },
      { label: "Inbound Ratio", value: "68% overall — people find you more than you reach out" },
      { label: "Growth Velocity", value: "3.2x increase in inbound over 7 months" }
    ]
  },
  quality: {
    stats: [
      { value: "2,264", label: "Connections" },
      { value: "485", label: "Ever Messaged" },
      { value: "26%", label: "Engaged Rate" }
    ],
    donut_labels: ["Active", "Some Contact", "Going Stale", "Dormant", "Deep Sleep", "Never Messaged"],
    donut_data: [47, 118, 18, 24, 278, 1362],
    bar_labels: ["Your Network"],
    bar_datasets: [
      { label: "Messaged", data: [485], backgroundColor: "#4eadabcc", borderRadius: 6, barPercentage: 0.6 },
      { label: "Never Messaged", data: [1362], backgroundColor: "rgba(255,255,255,0.08)", borderRadius: 6, barPercentage: 0.6 }
    ],
    breakdown: [
      { tier: "Active", description: "Messaged in last 30 days", count: 47, pct: "2.5%", bar_width: "100%", color: "#c9a84c" },
      { tier: "Some Contact", description: "Messaged in last 90 days", count: 118, pct: "6.4%", bar_width: "80%", color: "#4eadab" },
      { tier: "Going Stale", description: "Last message 90-180 days ago", count: 18, pct: "1.0%", bar_width: "12%", color: "#8b7ec8" },
      { tier: "Dormant", description: "Last message 6-12 months ago", count: 24, pct: "1.3%", bar_width: "16%", color: "#d4845a" },
      { tier: "Deep Sleep", description: "Last message over 1 year ago", count: 278, pct: "15.1%", bar_width: "65%", color: "#4a9f9d" },
      { tier: "Never Messaged", description: "Connected but never exchanged messages", count: 1362, pct: "73.7%", bar_width: "100%", color: "rgba(255,255,255,0.15)" }
    ],
    takeaways: [
      "<strong>73.7% of your network has never exchanged a single message with you.</strong> These are purely social connections with no active relationship.",
      "<strong>Only 2.5% are actively engaged</strong> (messaged in the last 30 days). Your real working network is roughly 47 people.",
      "<strong>278 connections are in Deep Sleep</strong> — you messaged them once but haven't spoken in over a year. Consider a re-engagement campaign for high-value dormant contacts."
    ]
  },
  pyramid: {
    tiers: ["C-Suite", "VP / Director", "Manager", "Individual Contributor", "Other"],
    inbound: [134, 296, 389, 512, 224],
    outbound: [47, 112, 177, 281, 92],
    stats: [
      { value: "69%", label: "Inbound" },
      { value: "31%", label: "Outbound" },
      { value: "C-Suite", label: "Highest Inbound %" },
      { value: "2,264", label: "Total Connections" }
    ]
  },
  inbox: {
    stats: [
      { value: "4,210", label: "Total Messages" },
      { value: "91.8%", label: "Genuine Rate" },
      { value: "344", label: "Noise Messages" },
      { value: "3.1x", label: "Volume Increase" }
    ],
    chart_labels: ["H1 '20", "H2 '20", "H1 '21", "H2 '21", "H1 '22", "H2 '22", "H1 '23", "H2 '23", "H1 '24", "H2 '24", "H1 '25", "H2 '25", "H1 '26"],
    genuine: [85, 110, 145, 168, 210, 235, 280, 310, 345, 390, 420, 485, 180],
    noise: [8, 12, 15, 18, 22, 25, 28, 30, 32, 35, 38, 42, 18],
    insights: [
      { label: "Genuine Rate Trend", value: "Stable at 91-93% across all periods" },
      { label: "Peak Volume", value: "H2 2025 — 92% genuine rate (527 total messages)" },
      { label: "Noise Sources", value: "Primarily InMail and automated recruiter outreach" },
      { label: "Response Pattern", value: "You respond to 78% of genuine messages within 48 hours" }
    ]
  },
  posting: {
    chart_title: "r = 0.91 — Posting drives connection growth",
    labels: ["Feb '24","Mar '24","Apr '24","May '24","Jun '24","Jul '24","Aug '24","Sep '24","Oct '24","Nov '24","Dec '24","Jan '25","Feb '25","Mar '25","Apr '25","May '25","Jun '25","Jul '25","Aug '25","Sep '25","Oct '25","Nov '25","Dec '25","Jan '26"],
    connections: [4, 5, 7, 3, 8, 5, 4, 6, 4, 7, 4, 41, 52, 27, 76, 84, 101, 112, 129, 123, 100, 137, 129, 145],
    posts: [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 2, 1, 2, 2, 2, 2, 2, 3],
    highlights: [
      { value: "0.91", label: "correlation coefficient", note: "(strong)" },
      { value: "1765%", label: "more connections/month", note: "after consistent posting" },
      { value: "5 → 97", label: "avg connections/month", note: "before vs after" }
    ]
  },
  strata: {
    stats: [
      { value: "7", label: "Career Phases" },
      { value: "14 yrs", label: "Network Span" },
      { value: "2022-25", label: "Peak Era" },
      { value: "612", label: "Largest Phase" },
      { value: "18.8%", label: "Newest Phase" }
    ],
    layers: [
      { era: "Consulting & Advisory (2025-2026)", desc: "Fractional CMO/CDO for DTC and B2B clients", detail: "Post-enterprise role. Recurring clients, new engagements, and heavy job search networking.", count: 425, pct: "18.8%" },
      { era: "That Time in B2B Dental (2022-2025)", desc: "VP Digital at a B2B e-commerce marketplace", detail: "Largest phase. PE exit, board-level connections, 40-person team, retail media launch.", count: 612, pct: "27.0%" },
      { era: "Fractional CMO (2020-2022)", desc: "Multi-client consulting across DTC and e-commerce", detail: "Heavy client portfolio. Conference and operator connections from DTC, luxury, and consumer brands.", count: 384, pct: "17.0%" },
      { era: "Brand-Side (2018-2020)", desc: "VP and Director roles at DTC and luxury brands", detail: "First VP title. Cross-industry connections from travel, fashion, luxury, and retail.", count: 338, pct: "14.9%" },
      { era: "The Come-Up (2017-2018)", desc: "Director of Marketing at a DTC home brand", detail: "First leadership role. Affiliate, media, and retail connections. E-commerce operator network established.", count: 228, pct: "10.1%" },
      { era: "First Marketing Role (2014-2017)", desc: "Director of Digital Marketing at a design-driven e-commerce brand", detail: "Entry into marketing from retail. Content-driven strategy, luxury and design world connections.", count: 186, pct: "8.2%" },
      { era: "Bedrock (2012-2014)", desc: "College, Apple Store, and early career", detail: "University peers, early professional connections, and the Tumblr community that started it all.", count: 91, pct: "4.0%" }
    ]
  }
};
</script>

<!-- RENDERING -->
<script>
Chart.defaults.color = '#8b949e';
Chart.defaults.font.family = "'Inter', sans-serif";
Chart.defaults.plugins.tooltip.backgroundColor = '#1E2329';
Chart.defaults.plugins.tooltip.titleColor = '#fdfdfe';
Chart.defaults.plugins.tooltip.bodyColor = '#8b949e';
Chart.defaults.plugins.tooltip.borderColor = 'rgba(255,255,255,0.08)';
Chart.defaults.plugins.tooltip.borderWidth = 1;
Chart.defaults.plugins.tooltip.cornerRadius = 8;
Chart.defaults.plugins.tooltip.padding = 12;

const VIZ = {
  teal: '#4eadab', lime: '#56d4a5', cyan: '#6bc0be', purple: '#8b7ec8',
  orange: '#d4845a', gold: '#c9a84c', muted: '#8b949e', deep: '#4a9f9d',
  slate: '#7d8590', pink: '#c75b6f'
};
const PALETTE = [VIZ.teal, VIZ.lime, VIZ.cyan, VIZ.purple, VIZ.orange, VIZ.gold, VIZ.muted, VIZ.deep, VIZ.slate, VIZ.pink, '#5ab8b6', '#7dcbc9', '#8ed6d4', '#9fe1df', '#b0ecea', '#c1f7f5', '#fdfdfe'];

function renderStats(id, stats) {
  const el = document.getElementById(id);
  if (!el) return;
  el.innerHTML = stats.map(s => `<div class="stat"><div class="stat-value">${s.value}</div><div class="stat-label">${s.label}</div></div>`).join('');
}

function renderInsights(id, insights) {
  const el = document.getElementById(id);
  if (!el) return;
  el.innerHTML = insights.map(i => `<div class="insight"><div class="insight-label">${i.label}</div><div class="insight-value">${i.value}</div></div>`).join('');
}

/* NAV SCROLL-SPY */
const navLinks = document.querySelectorAll('.nav-link');
const sections = document.querySelectorAll('section');
const observer = new IntersectionObserver(entries => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      navLinks.forEach(l => l.classList.remove('active'));
      const active = document.querySelector(`.nav-link[href="#${entry.target.id}"]`);
      if (active) active.classList.add('active');
    }
  });
}, { rootMargin: '-100px 0px -60% 0px' });
sections.forEach(s => observer.observe(s));

/* HERO */
if (DATA.hero) renderStats('hero-stats', DATA.hero.stats);

/* 01: NETWORK UNIVERSE — Cluster graph with "You" center node */
if (DATA.network) {
  const nd = DATA.network;
  renderStats('network-stats', nd.stats || []);

  const gc = document.getElementById('graph');
  const gw = gc.clientWidth, gh = 800;
  const gsvg = d3.select('#graph').append('svg').attr('viewBox', `0 0 ${gw} ${gh}`).attr('preserveAspectRatio', 'xMidYMid meet');
  const gTip = document.getElementById('tooltip');

  /* Zoom/pan container — all drawing goes inside zoomG */
  const zoomG = gsvg.append('g');
  const zoom = d3.zoom().scaleExtent([0.3, 3]).on('zoom', (e) => { zoomG.attr('transform', e.transform); });
  gsvg.call(zoom);

  /* Build parent nodes + recursive child map */
  const parentNodes = nd.nodes.map(n => ({ ...n, _depth: 0, _expanded: true }));
  let allNodes = [];
  let allLinks = [];
  const childMap = new Map();

  function buildChildMap(nodes, depth) {
    nodes.forEach(n => {
      if (n.children && n.children.length > 0) {
        const kids = n.children.map(c => ({ ...c, _depth: depth + 1, _parent: n.id, _expanded: false, top_companies: c.top_companies || [] }));
        childMap.set(n.id, kids);
        buildChildMap(n.children, depth + 1);
      }
    });
  }
  buildChildMap(nd.nodes, 0);

  /* "You" central node */
  const youNode = { id: 'You', size: 1847, group: -1, _depth: -1, _expanded: true };
  allNodes.push(youNode);
  allNodes = allNodes.concat(parentNodes);

  /* You → parent links (strength = parent size) */
  const maxParentSize = d3.max(parentNodes, d => d.size);
  const minParentSize = d3.min(parentNodes, d => d.size);
  parentNodes.forEach(p => {
    allLinks.push({ source: 'You', target: p.id, strength: p.size, _youLink: true });
  });

  /* Parent ↔ parent links */
  allLinks = allLinks.concat(nd.links);

  /* Auto-expand parents on load (children visible immediately) */
  parentNodes.forEach(p => {
    if (childMap.has(p.id)) {
      const kids = childMap.get(p.id);
      allNodes = allNodes.concat(kids);
      kids.forEach(k => {
        allLinks.push({ source: p.id, target: k.id, strength: k.size, _childLink: true, _group: p.group });
      });
    }
  });

  /* Radius scales — wide ranges for clear visual hierarchy */
  const youRadius = 55;
  const parentRadiusScale = d3.scalePow().exponent(0.5).domain([minParentSize, maxParentSize]).range([22, 72]);
  const child1Scale = d3.scalePow().exponent(0.5).domain([0, d3.max(allNodes.filter(n=>n._depth===1),d=>d.size)||120]).range([6, 26]);
  const child2Scale = d3.scalePow().exponent(0.5).domain([0, 50]).range([3, 14]);
  function nodeRadius(d) {
    if (d._depth === -1) return youRadius;
    if (d._depth === 0) return parentRadiusScale(d.size);
    if (d._depth === 1) return child1Scale(d.size);
    return child2Scale(d.size);
  }

  /* Link weight scales */
  const youLinkScale = d3.scaleLinear().domain([minParentSize, maxParentSize]).range([1.5, 6]);
  const maxCrossStrength = d3.max(nd.links, d => d.strength) || 22;
  function linkWidth(d) {
    if (d._youLink) return youLinkScale(d.strength);
    if (d._childLink) return Math.max(1, (d.strength / 120) * 3);
    return Math.max(0.8, (d.strength || 4) / maxCrossStrength * 2.5);
  }
  function linkOpacity(d) {
    if (d._youLink) return 0.35;
    if (d._childLink) return Math.max(0.35, (d.strength / 120) * 0.6);
    return 0.18;
  }

  /* Recursive helper: collect all descendant IDs */
  function getDescendantIds(nodeId) {
    const ids = new Set();
    const kids = childMap.get(nodeId);
    if (!kids) return ids;
    kids.forEach(k => { ids.add(k.id); k._expanded = false; getDescendantIds(k.id).forEach(id => ids.add(id)); });
    return ids;
  }

  const linkLayer = zoomG.append('g');
  const nodeLayer = zoomG.append('g');
  let gSim;
  const cx = gw / 2, cy = gh / 2;

  /* Radial distance: more connections = closer to You */
  const distScale = d3.scaleLinear().domain([maxParentSize, minParentSize]).range([130, 240]);

  /* Seed positions — You starts at center (no fx/fy lock) */
  youNode.x = cx; youNode.y = cy;

  /* Seed parents at radial positions — evenly spaced angles, distance by size */
  parentNodes.forEach((p, i) => {
    const a = (i / parentNodes.length) * 2 * Math.PI - Math.PI / 2;
    const r = distScale(p.size);
    p.x = cx + Math.cos(a) * r;
    p.y = cy + Math.sin(a) * r;
  });

  /* Seed children in fan arc radiating outward from parent */
  allNodes.forEach(d => {
    if (d._depth >= 1 && d._parent) {
      const par = allNodes.find(n => n.id === d._parent);
      if (par && par.x != null) {
        const siblings = childMap.get(d._parent) || [];
        const idx = siblings.indexOf(d);
        const count = siblings.length;
        const pAngle = Math.atan2(par.y - cy, par.x - cx);
        const fanSpread = Math.min(Math.PI * 0.6, count * 0.25);
        const childAngle = pAngle - fanSpread / 2 + (count > 1 ? idx / (count - 1) * fanSpread : 0);
        const childDist = nodeRadius(par) + nodeRadius(d) + 20;
        d.x = par.x + Math.cos(childAngle) * childDist;
        d.y = par.y + Math.sin(childAngle) * childDist;
      }
    }
  });

  function buildSim() {
    if (gSim) gSim.stop();
    gSim = d3.forceSimulation(allNodes)
      .force('link', d3.forceLink(allLinks).id(d => d.id)
        .distance(d => {
          if (d._youLink) return distScale(d.strength);
          if (d._childLink) return nodeRadius(d.source) + nodeRadius(d.target) + 20;
          return 220;
        })
        .strength(d => {
          if (d._youLink) return 0.25;
          if (d._childLink) return 0.7;
          return 0.02;
        })
      )
      .force('charge', d3.forceManyBody().strength(d => {
        if (d._depth === -1) return -1800;
        if (d._depth === 0) return -500 - d.size * 0.8;
        return -30;
      }))
      .force('center', d3.forceCenter(cx, cy).strength(0.03))
      .force('radial', d3.forceRadial(d => d._depth === 0 ? distScale(d.size) : 0, cx, cy).strength(d => d._depth === 0 ? 0.5 : 0))
      .force('collision', d3.forceCollide().radius(d => nodeRadius(d) + 8).strength(0.9));
    return gSim;
  }

  function renderDOM() {
    /* Links */
    const linkSel = linkLayer.selectAll('line').data(allLinks, d => (d.source.id || d.source) + '-' + (d.target.id || d.target));
    linkSel.exit().remove();
    const linkEnter = linkSel.enter().append('line').attr('class', 'graph-link');
    const linkMerge = linkEnter.merge(linkSel);
    linkMerge
      .attr('stroke-width', d => linkWidth(d))
      .attr('stroke-opacity', d => linkOpacity(d))
      .attr('stroke', d => {
        if (d._youLink) return 'rgba(255,255,255,0.5)';
        if (d._childLink) return PALETTE[d._group % PALETTE.length];
        return 'rgba(255,255,255,0.2)';
      })
      .attr('stroke-dasharray', d => (!d._youLink && !d._childLink) ? '5,4' : null);

    /* Nodes */
    const nodeSel = nodeLayer.selectAll('g.node').data(allNodes, d => d.id);
    nodeSel.exit().remove();

    const dragHandler = d3.drag()
      .on('start', (e, d) => { if (!e.active) gSim.alphaTarget(0.3).restart(); d.fx = d.x; d.fy = d.y; })
      .on('drag', (e, d) => { const t = d3.zoomTransform(gsvg.node()); d.fx = (e.sourceEvent.offsetX - t.x) / t.k; d.fy = (e.sourceEvent.offsetY - t.y) / t.k; })
      .on('end', (e, d) => { if (!e.active) gSim.alphaTarget(0); d.fx = null; d.fy = null; });
    const nodeEnter = nodeSel.enter().append('g').attr('class', 'node').call(dragHandler);
    nodeEnter.append('circle');
    nodeEnter.append('text').attr('class', 'node-label').attr('text-anchor', 'middle');

    const nodeMerge = nodeEnter.merge(nodeSel);
    nodeMerge.selectAll('.node-count').remove();
    nodeMerge.attr('opacity', 1);

    nodeMerge.select('circle')
      .attr('r', d => nodeRadius(d))
      .attr('fill', d => d._depth === -1 ? '#fdfdfe' : PALETTE[d.group % PALETTE.length])
      .attr('fill-opacity', d => d._depth === -1 ? 0.95 : d._depth === 0 ? 1.0 : d._depth === 1 ? 0.75 : 0.6)
      .attr('stroke', 'none')
      .style('cursor', 'pointer');

    /* Labels: all centered inside nodes */
    nodeMerge.select('.node-label')
      .attr('dy', '0.35em')
      .attr('text-anchor', 'middle')
      .style('font-size', d => d._depth === -1 ? '13px' : d._depth === 0 ? '11px' : d._depth === 1 ? '8px' : '7px')
      .style('fill', d => d._depth === -1 ? 'var(--bg-primary)' : '#fff')
      .style('font-weight', d => d._depth <= 0 ? '600' : '500')
      .text(d => nodeRadius(d) < 10 ? '' : d.id);

    /* Tooltip on click for child nodes (depth >= 1) only */
    nodeMerge.on('click', (e, d) => {
      e.stopPropagation();
      if (d._depth >= 1) {
        const info = d.top_companies && d.top_companies.length
          ? `<div class="companies">Top: ${d.top_companies.join(', ')}</div>`
          : d._parent ? `<div class="companies">Cluster: ${d._parent}</div>` : '';
        gTip.innerHTML = `<strong>${d.id}</strong><br>${d.size} connections${info}`;
        gTip.style.opacity = 1;
        gTip.style.left = (e.offsetX + 15) + 'px';
        gTip.style.top = (e.offsetY - 10) + 'px';
      }
      /* Expand/collapse grandchildren */
      if (childMap.has(d.id) && d._depth >= 1) {
        d._expanded = !d._expanded;
        if (d._expanded) {
          const kids = childMap.get(d.id);
          const pAngle = Math.atan2(d.y - cy, d.x - cx);
          const count = kids.length;
          const fanSpread = Math.min(Math.PI * 0.6, count * 0.25);
          kids.forEach((k, ki) => {
            const childAngle = pAngle - fanSpread / 2 + (count > 1 ? ki / (count - 1) * fanSpread : 0);
            const childDist = nodeRadius(d) + nodeRadius(k) + 20;
            k.x = d.x + Math.cos(childAngle) * childDist;
            k.y = d.y + Math.sin(childAngle) * childDist;
          });
          allNodes = allNodes.concat(kids);
          kids.forEach(k => { allLinks.push({ source: d.id, target: k.id, strength: k.size, _childLink: true, _group: d.group }); });
        } else {
          const descIds = getDescendantIds(d.id);
          allNodes = allNodes.filter(n => !descIds.has(n.id));
          allLinks = allLinks.filter(l => {
            if (!l._childLink) return true;
            const sid = l.source.id || l.source;
            const tid = l.target.id || l.target;
            return !descIds.has(tid) && !descIds.has(sid);
          });
        }
        render();
      }
    });

    gsvg.on('click', () => { gTip.style.opacity = 0; });

    return { linkMerge, nodeMerge };
  }

  function render() {
    buildSim();
    gSim.tick(400);
    gSim.stop();
    const { linkMerge, nodeMerge } = renderDOM();
    linkMerge.attr('x1', d => d.source.x).attr('y1', d => d.source.y).attr('x2', d => d.target.x).attr('y2', d => d.target.y);
    nodeMerge.attr('transform', d => `translate(${d.x},${d.y})`);
    gSim.on('tick', () => {
      linkMerge.attr('x1', d => d.source.x).attr('y1', d => d.source.y).attr('x2', d => d.target.x).attr('y2', d => d.target.y);
      nodeMerge.attr('transform', d => `translate(${d.x},${d.y})`);
    });
    gSim.alpha(0).restart();
  }

  render();

  /* Legend */
  const gLeg = document.getElementById('legend');
  gLeg.innerHTML = `<div class="legend-item"><div class="legend-dot" style="background:#fdfdfe"></div>You (${youNode.size})</div>`;
  [...parentNodes].sort((a, b) => b.size - a.size).forEach(n => {
    gLeg.innerHTML += `<div class="legend-item"><div class="legend-dot" style="background:${PALETTE[n.group % PALETTE.length]}"></div>${n.id} (${n.size})</div>`;
  });
}

/* 02: INFERENCES */
if (DATA.inferences) {
  const inf = DATA.inferences;
  renderStats('inference-stats', inf.stats || []);
  const ig = document.getElementById('inference-grid');
  if (ig && inf.cards) {
    ig.innerHTML = inf.cards.map((c, i) => {
      const span = i === inf.cards.length - 1 && inf.cards.length % 2 === 1 ? ' style="grid-column:span 2;"' : '';
      return `<div class="inference-card"${span}><div class="card-header"><span class="verdict ${c.verdict}">${c.verdict}</span><span class="card-label">${c.label}</span></div><div class="linkedin-says">${c.linkedin_says}</div><div class="reality"><strong>Reality:</strong> ${c.reality}</div></div>`;
    }).join('');
  }
  const ft = document.getElementById('follows-title');
  if (ft && inf.follows_count) ft.textContent = `What You Actually Follow (${inf.follows_count} Companies)`;
  const fg = document.getElementById('follows-grid');
  if (fg && inf.follows) {
    fg.innerHTML = inf.follows.map((f, i) => {
      const color = PALETTE[i % PALETTE.length];
      return `<div class="follows-cat" style="border-left:3px solid ${color};"><div class="follows-cat-count" style="color:${color};">${f.count}</div><div class="follows-cat-label">${f.label}</div></div>`;
    }).join('');
  }
  const it = document.getElementById('interest-tags');
  if (it && inf.interest_tags) it.innerHTML = inf.interest_tags.map(t => `<span class="tag ${t.type}">${t.name}</span>`).join('');
  const vr = document.getElementById('verdict-rows');
  if (vr && inf.verdicts) {
    vr.innerHTML = inf.verdicts.map(v => `<div class="comparison-row"><div class="col-linkedin"><div class="col-label">${v.linkedin_label}</div><div class="col-value">${v.linkedin_value}</div></div><div class="vs-divider">vs</div><div class="col-reality"><div class="col-label">Reality</div><div class="col-value">${v.reality_value}</div></div></div>`).join('');
  }
}

/* 03: MESSAGES */
if (DATA.messages) {
  const msg = DATA.messages;
  renderStats('msg-stats', msg.stats || []);
  const mc = document.getElementById('msg-cards');
  if (mc && msg.cards) {
    mc.innerHTML = msg.cards.map(m => {
      const tags = (m.tags || []).map(t => `<span class="msg-tag ${t.type}">${t.label}</span>`).join('');
      const subject = m.subject ? `<div class="msg-subject">${m.subject}</div>` : '';
      return `<div class="msg-card" data-type="${m.type}"><div class="urgency ${m.urgency}"></div><div class="msg-body"><div class="msg-header"><span class="msg-from">${m.from}</span><div class="msg-meta"><span class="msg-date">${m.date}</span><span class="msg-days ${m.age_class}">${m.age}</span></div></div>${subject}<div class="msg-content">${m.content}</div><div class="msg-tags">${tags}</div></div></div>`;
    }).join('');
  }
  document.querySelectorAll('.filter-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      const f = btn.dataset.filter;
      document.querySelectorAll('.msg-card').forEach(c => { c.classList.toggle('hidden', f !== 'all' && c.dataset.type !== f); });
    });
  });
}

/* 04: COMPANY CLUSTERS */
if (DATA.company_clusters) {
  const cc = DATA.company_clusters;
  new Chart(document.getElementById('clusterChart').getContext('2d'), {
    type: 'bar',
    data: { labels: cc.chart_labels, datasets: [{ data: cc.chart_data, backgroundColor: cc.chart_labels.map((_, i) => PALETTE[i % PALETTE.length] + 'cc'), borderColor: cc.chart_labels.map((_, i) => PALETTE[i % PALETTE.length]), borderWidth: 1, borderRadius: 6, barPercentage: 0.7 }] },
    options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { grid: { display: false }, ticks: { font: { family: 'Inter', size: 10 }, color: '#7d8590' } }, y: { grid: { color: 'rgba(255,255,255,0.08)' }, ticks: { font: { family: 'Inter', size: 11 }, color: '#7d8590' }, beginAtZero: true } } }
  });
  const cg = document.getElementById('cluster-grid');
  if (cg && cc.clusters) {
    cg.innerHTML = cc.clusters.map((cl, i) => {
      const color = PALETTE[i % PALETTE.length];
      return `<div class="cluster-card" style="border-left:3px solid ${color};"><div class="cluster-header"><span class="cluster-name" style="color:${color};">${cl.name}</span><span class="cluster-count" style="color:${color};">${cl.count}</span></div><div class="cluster-items">${cl.companies.map(c => `<span>${c}</span>`).join('')}</div></div>`;
    }).join('');
  }
}

/* 05: INVITATIONS */
if (DATA.invitations) {
  const inv = DATA.invitations;
  renderStats('inv-stats', inv.stats || []);
  renderInsights('inv-insights', inv.insights || []);
  new Chart(document.getElementById('invChart').getContext('2d'), {
    type: 'bar',
    data: { labels: inv.chart_labels, datasets: [
      { label: 'Inbound', data: inv.inbound, backgroundColor: VIZ.teal + 'cc', borderRadius: 6, barPercentage: 0.8, categoryPercentage: 0.7 },
      { label: 'Outbound', data: inv.outbound, backgroundColor: VIZ.slate + 'aa', borderRadius: 6, barPercentage: 0.8, categoryPercentage: 0.7 }
    ] },
    options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'top', align: 'end', labels: { font: { family: 'Inter', size: 11 }, color: '#8b949e', boxWidth: 12, padding: 14 } } }, scales: { x: { grid: { display: false }, ticks: { font: { family: 'Inter', size: 11 }, color: '#7d8590' } }, y: { grid: { color: 'rgba(255,255,255,0.08)' }, ticks: { font: { family: 'Inter', size: 11 }, color: '#7d8590' }, beginAtZero: true } } }
  });
}

/* 06: QUALITY */
if (DATA.quality) {
  const q = DATA.quality;
  renderStats('quality-stats', q.stats || []);
  new Chart(document.getElementById('donutChart').getContext('2d'), {
    type: 'doughnut',
    data: { labels: q.donut_labels, datasets: [{ data: q.donut_data, backgroundColor: [VIZ.gold + 'cc', VIZ.teal + 'cc', VIZ.purple + 'cc', VIZ.orange + 'aa', VIZ.deep + '99', 'rgba(255,255,255,0.08)'], borderWidth: 2, borderColor: '#161B22' }] },
    options: { responsive: true, maintainAspectRatio: false, cutout: '55%', plugins: { legend: { position: 'bottom', labels: { font: { family: 'Inter', size: 10 }, color: '#8b949e', boxWidth: 10, padding: 8 } } } }
  });
  if (q.bar_datasets) {
    new Chart(document.getElementById('barChart').getContext('2d'), {
      type: 'bar', data: { labels: q.bar_labels, datasets: q.bar_datasets },
      options: { responsive: true, maintainAspectRatio: false, indexAxis: 'y', scales: { x: { stacked: true, grid: { color: 'rgba(255,255,255,0.08)' } }, y: { stacked: true, grid: { display: false } } }, plugins: { legend: { position: 'bottom', labels: { font: { family: 'Inter', size: 10 }, color: '#8b949e', boxWidth: 10, padding: 8 } } } }
    });
  }
  const qb = document.getElementById('quality-breakdown');
  if (qb && q.breakdown) {
    qb.innerHTML = q.breakdown.map(b => `<div class="breakdown-row"><div class="breakdown-dot" style="background:${b.color};"></div><div class="breakdown-label"><strong>${b.tier}</strong> — ${b.description}</div><div class="breakdown-count">${b.count}</div><div class="breakdown-pct">${b.pct}</div><div class="breakdown-bar"><div class="breakdown-fill" style="width:${b.bar_width};background:${b.color};"></div></div></div>`).join('');
  }
  const qt = document.getElementById('quality-takeaways');
  if (qt && q.takeaways) qt.innerHTML = q.takeaways.map(t => `<div class="takeaway">${t}</div>`).join('');
}

/* 07: PYRAMID */
if (DATA.pyramid) {
  const py = DATA.pyramid;
  const pyramidLabels = {
    id: 'pyramidLabels',
    afterDatasetsDraw(chart) {
      const { ctx } = chart;
      const xCenter = chart.scales.x.getPixelForValue(0);
      const inMeta = chart.getDatasetMeta(1);
      const outMeta = chart.getDatasetMeta(0);
      chart.data.labels.forEach((label, i) => {
        const bar = inMeta.data[i];
        const outBar = outMeta.data[i];
        const inVal = py.inbound[i];
        const outVal = py.outbound[i];
        const pct = Math.round(inVal / (inVal + outVal) * 100);
        /* tier name inside inbound bar */
        ctx.fillStyle = 'rgba(13,17,23,0.85)';
        ctx.font = '600 12px Inter';
        ctx.textAlign = 'left';
        ctx.textBaseline = 'middle';
        ctx.fillText(label, xCenter + 10, bar.y);
        /* inbound count at right end */
        ctx.fillStyle = '#c9d1d9';
        ctx.font = '500 11px Inter';
        ctx.textAlign = 'left';
        ctx.fillText(inVal, bar.x + 8, bar.y);
        /* outbound count at left end */
        ctx.textAlign = 'right';
        ctx.fillText(outVal, outBar.x - 8, outBar.y);
        /* inbound % badge at right of inbound count */
        ctx.fillStyle = '#4eadab88';
        ctx.font = '400 10px Inter';
        ctx.textAlign = 'left';
        ctx.fillText(pct + '% in', bar.x + 8 + ctx.measureText(inVal + '').width + 8, bar.y);
      });
    }
  };
  new Chart(document.getElementById('pyramidChart').getContext('2d'), {
    type: 'bar',
    data: {
      labels: py.tiers,
      datasets: [
        { label: 'Outbound (you → them)', data: py.outbound.map(v => -v), backgroundColor: VIZ.gold + 'cc', borderRadius: 4, barPercentage: 0.82, categoryPercentage: 0.75 },
        { label: 'Inbound (them → you)', data: py.inbound, backgroundColor: VIZ.teal + 'cc', borderRadius: 4, barPercentage: 0.82, categoryPercentage: 0.75 }
      ]
    },
    options: {
      indexAxis: 'y', responsive: true, maintainAspectRatio: false,
      plugins: {
        legend: { position: 'top', align: 'center', labels: { font: { family: 'Inter', size: 11 }, color: '#8b949e', boxWidth: 12, padding: 14 } },
        tooltip: { callbacks: { label: ctx => `${ctx.dataset.label}: ${Math.abs(ctx.raw)}` } }
      },
      scales: {
        x: {
          stacked: true,
          grid: { color: 'rgba(255,255,255,0.06)' },
          ticks: { font: { family: 'Inter', size: 11 }, color: '#7d8590', callback: v => Math.abs(v) },
          title: { display: true, text: 'Connections', color: '#7d8590', font: { family: 'Inter', size: 11 } }
        },
        y: {
          stacked: true,
          grid: { display: false },
          ticks: { display: false }
        }
      }
    },
    plugins: [pyramidLabels]
  });
  renderStats('pyramid-stats', py.stats || []);
}

/* 08: INBOX */
if (DATA.inbox) {
  const iq = DATA.inbox;
  renderStats('inbox-stats', iq.stats || []);
  renderInsights('inbox-insights', iq.insights || []);
  new Chart(document.getElementById('inboxChart').getContext('2d'), {
    type: 'bar',
    data: { labels: iq.chart_labels, datasets: [
      { label: 'Genuine', data: iq.genuine, backgroundColor: VIZ.teal + 'cc', borderRadius: 4, barPercentage: 0.85 },
      { label: 'Junk', data: iq.noise, backgroundColor: VIZ.pink + 'aa', borderRadius: 4, barPercentage: 0.85 }
    ] },
    options: { responsive: true, maintainAspectRatio: false, scales: { x: { stacked: true, grid: { display: false }, ticks: { font: { family: 'Inter', size: 9 }, color: '#7d8590', maxRotation: 45 } }, y: { stacked: true, grid: { color: 'rgba(255,255,255,0.08)' }, ticks: { font: { family: 'Inter', size: 11 }, color: '#7d8590' }, beginAtZero: true } }, plugins: { legend: { position: 'top', align: 'end', labels: { font: { family: 'Inter', size: 11 }, color: '#8b949e', boxWidth: 12, padding: 14 } }, tooltip: { callbacks: { afterBody: function(ctx) { const i = ctx[0].dataIndex; const t = iq.genuine[i] + iq.noise[i]; return t > 0 ? `Genuine: ${((iq.genuine[i] / t) * 100).toFixed(1)}%` : ''; } } } } }
  });
}

/* 09: POSTING CORRELATION */
if (DATA.posting) {
  const pc = DATA.posting;
  new Chart(document.getElementById('postingChart').getContext('2d'), {
    type: 'bar',
    data: {
      labels: pc.labels,
      datasets: [
        { label: 'New Connections', data: pc.connections, backgroundColor: VIZ.gold + 'cc', borderRadius: 4, barPercentage: 0.75, order: 2, yAxisID: 'y' },
        { label: 'Posts', data: pc.posts, type: 'line', borderColor: VIZ.teal, backgroundColor: VIZ.teal + '22', pointBackgroundColor: VIZ.teal, pointRadius: 3, pointHoverRadius: 5, borderWidth: 2, tension: 0.3, fill: true, order: 1, yAxisID: 'y1' }
      ]
    },
    options: {
      responsive: true, maintainAspectRatio: false,
      plugins: {
        title: { display: true, text: pc.chart_title, color: '#8b949e', font: { family: 'Inter', size: 13, weight: '400' }, padding: { bottom: 16 } },
        legend: { position: 'top', align: 'center', labels: { font: { family: 'Inter', size: 11 }, color: '#8b949e', boxWidth: 12, padding: 14, usePointStyle: false } }
      },
      scales: {
        x: { grid: { display: false }, ticks: { font: { family: 'Inter', size: 9 }, color: '#7d8590', maxRotation: 45 } },
        y: { position: 'left', title: { display: true, text: 'New Connections', color: '#7d8590', font: { family: 'Inter', size: 11 } }, grid: { color: 'rgba(255,255,255,0.08)' }, ticks: { font: { family: 'Inter', size: 11 }, color: '#7d8590' }, beginAtZero: true },
        y1: { position: 'right', title: { display: true, text: 'Posts', color: '#7d8590', font: { family: 'Inter', size: 11 } }, grid: { drawOnChartArea: false }, ticks: { font: { family: 'Inter', size: 11 }, color: '#7d8590', stepSize: 1 }, beginAtZero: true, max: 14 }
      }
    }
  });
  const ph = document.getElementById('posting-highlights');
  if (ph && pc.highlights) {
    ph.innerHTML = pc.highlights.map(h => `<div class="highlight-card"><div class="highlight-value">${h.value}</div><div class="highlight-label">${h.label}</div><div class="highlight-note">${h.note}</div></div>`).join('');
  }
}

/* 10: STRATA */
if (DATA.strata) {
  const st = DATA.strata;
  renderStats('strata-stats', st.stats || []);
  const sc = document.getElementById('strata-container');
  if (sc && st.layers) {
    sc.innerHTML = st.layers.map((l, i) => {
      const layerIdx = st.layers.length - 1 - i;
      return `<div class="strata-layer layer-${Math.min(layerIdx, 8)}"><div><div class="strata-era">${l.era}</div><div class="strata-desc">${l.desc}</div><div class="strata-detail">${l.detail}</div></div><div class="strata-right"><div class="strata-count">${l.count}</div><div class="strata-pct">${l.pct}</div></div></div>`;
    }).join('');
  }
}
</script>
</body>
</html>
